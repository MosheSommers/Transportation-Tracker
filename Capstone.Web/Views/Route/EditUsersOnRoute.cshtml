@model Capstone.Web.Models.Route

@{
    ViewBag.Title = "Add a User to a Route";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<h2> Add a user to Route: @Model.RouteName </h2>
<hr />

<div id="right-panel">
    <form action="@Url.Action("UpdateUsersOnRoute")" method="post">
        <div>
            <input id="Waypoints[0]" class="waypointAdder" type="text" name="User[0]" placeholder="Enter e-mail address" />
        </div>
        <input type="submit" id="submit">
    </form>

</div>
<div>

    @for (int i = 0; i < Model.Users.Count; i++)
            {
        @Model.Users[i]<br />
    }

</div>





@*<div id="right-panel">
        <div>
            <form action="@Url.Action("UpdateUsersOnRoute")" method="post">
                @{ if (Model.Users.Count != 0)
                {
                    for (int i = 0; i < Model.Users.Count; i++)
                    {
                            <div>
                                <input id="Waypoints[@i]" class="waypointAdder" type="text" name="User[@i]" />
                                <button type="button" id="add-btn[@i]" class="add-btn">Add User</button>
                                <button type="button" id="rmv-btn[@i]" class="rmv-btn">Remove User</button>
                                <hr />
                            </div>
                        }
                    }
                    else
                    {
                        <div>
                            <input id="Waypoints[0]" class="waypointAdder" type="text" name="User[0]" placeholder="Enter e-mail address" />
                            <button type="button" id="add-btn" class="add-btn">Add User</button>

                            <hr />
                        </div>
                    }

                }
                <input type="submit" id="submit">
            </form>
        </div>
    </div>*@

<script>
    $('form').on('click', '.add-btn', function () {
        var currentStopCount = $('.waypointAdder').length;
        var stopIndex = $(this).index('.add-btn');

        for (var i = currentStopCount - 1; i > stopIndex; i--) {
            $('#Waypoints\\[' + i + '\\]').attr("name", "User\[" + (i + 1) + "\]");
            $('#Waypoints\\[' + i + '\\]').attr("id", "Waypoints\[" + (i + 1) + "\]");
            $('#add-btn\\[' + i + '\\]').attr("id", "add-btn\[" + (i + 1) + "\]");
            $('#rmv-btn\\[' + i + '\\]').attr("id", "rmv-btn\[" + (i + 1) + "\]");
        }
        $(this).parent().after("<div><input id='Waypoints\[" + (stopIndex + 1) + "\]' class='waypointAdder' type='text' name='User\[" + (stopIndex + 1) + "\]' placeholder='New User'/><button type='button' id='add-btn\[" + (stopIndex + 1) + "\]' class='add-btn'>Add User</button><button type='button' id='rmv-btn\[" + (stopIndex + 1) + "\]' class='rmv-btn'>Remove User</button><hr \></div>");
    });

    $('form').on('click', '.rmv-btn', function () {
        var currentStopCount = $('.waypointAdder').length;
        var stopIndex = $(this).index('.rmv-btn');


        for (var i = stopIndex + 1; i < currentStopCount; i++) {
            $('#Waypoints\\[' + i + '\\]').attr("name", "User\[" + (i - 1) + "\]");
            $('#Waypoints\\[' + i + '\\]').attr("id", "Waypoints\[" + (i - 1) + "\]");
            $('#add-btn\\[' + i + '\\]').attr("id", "add-btn\[" + (i - 1) + "\]");
            $('#rmv-btn\\[' + i + '\\]').attr("id", "rmv-btn\[" + (i - 1) + "\]");

            $(this).parent().remove();
        }
    });
</script>


